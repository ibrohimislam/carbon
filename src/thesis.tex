%--------------------------------------------------------------------%
%
% Berkas utama templat LaTeX.
%
% author Petra Barus, Peb Ruswono Aryan
%
%--------------------------------------------------------------------%
%
% Berkas ini berisi struktur utama dokumen LaTeX yang akan dibuat.
%
%--------------------------------------------------------------------%
\documentclass[12pt, a4paper, onecolumn, oneside, final, bahasa]{report}
\special{papersize=210mm,297mm}

% set margin
%\usepackage{showframe}
\usepackage[top=2.7cm,bottom=3cm,left=4cm,right=3cm]{geometry}

% set font
\usepackage{mathptmx}

% judul bahasa Indonesia
\usepackage[bahasa]{babel}

% satu setengah spasi
\renewcommand{\baselinestretch}{1.5}

\usepackage[utf8]{inputenc}

% citation style
\usepackage[backend=bibtex,style=authoryear]{biblatex}

\usepackage[activate={true,nocompatibility},final,tracking=true,kerning=true,spacing=true,factor=1100,stretch=10,shrink=10]{microtype}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{titling}
\usepackage{blindtext}
\usepackage{sectsty}
\usepackage{chngcntr}
\usepackage[table,xcdraw]{xcolor}
\usepackage{textcomp}
\usepackage{float}
\usepackage{caption}
\usepackage{tabularx}
\usepackage{multirow}
\usepackage[toc,page,header]{appendix}

%remove spacing before chapter
\usepackage{titlesec}
\titleformat{\chapter}[display]
{\normalfont\large\bfseries\centering}{\chaptertitlename\ \thechapter}{8pt}{\centering\large}
\titlespacing*{\chapter}{0pt}{-20pt}{40pt}

%merapikan antara nomor list dan textnya
\usepackage{tocloft}
\setlength{\cfttabnumwidth}{1.5cm}
\setlength{\cftfignumwidth}{1.5cm}

\renewcommand{\cftpartpresnum}{\partname\hspace{10pt}}
\renewcommand{\cftchappresnum}{\chaptername\hspace{5pt}}

\renewcommand{\cftpartleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

\renewcommand{\cftchapnumwidth}{4.2em}

\setlength{\cftbeforetoctitleskip}{-20pt}
\renewcommand{\cfttoctitlefont}{\hfill\large\bfseries}
\renewcommand{\cftaftertoctitle}{\hfill\hfill}

\setlength{\cftbeforeloftitleskip}{-20pt}
\renewcommand{\cftloftitlefont}{\hfill\hfill\large\bfseries}
\renewcommand{\cftafterloftitle}{\hfill\hfill}

\setlength{\cftbeforelottitleskip}{-20pt}
\renewcommand{\cftlottitlefont}{\hfill\hfill\large\bfseries}
\renewcommand{\cftafterlottitle}{\hfill\hfill}

% Daftar Lampiran %
\newcommand{\listappendixname}{Daftar Lampiran}
\newlistof{appendix}{app}{\listappendixname}
\setcounter{appdepth}{2}
\makeatletter
\AtBeginDocument{
	\newcommand{\@maketoatitle}{%
		\vspace*{\cftbeforeloftitleskip}
		\interlinepenalty\@M
		{\cftloftitlefont\listappendixname}{\cftafterloftitle}
		\cftmarklof
		\par\nobreak
		\vskip \cftafterloftitleskip
		\@afterheading
	}
	\renewcommand{\listofappendix}{
		\renewcommand{\cftchappresnum}{\appendixname\hspace{5pt}}
		\renewcommand{\cftchapnumwidth}{6em}
		\@cfttocstart
		\par
		\begingroup
			\@maketoatitle
			\parindent\z@ \parskip\z@
			\@starttoc{app}%
		\endgroup
	}
}
\makeatother
\newcommand{\chapterappendix}[1]{%
	\stepcounter{chapter}
	\chapter*{\appendixname\space\thechapter\linebreak#1}%
	\addcontentsline{app}{chapter}{\protect\numberline{\thechapter}#1}%
	\par
}
\newcommand{\sectionappendix}[1]{%
	\stepcounter{section}
	\section*{\thesection\quad#1}%
	\addcontentsline{app}{section}{\protect\numberline{\thesection}#1}%
}
\newcommand{\subsectionappendix}[1]{%
	\stepcounter{subsection}
	\subsection*{\thesubsection\quad#1}%
	\addcontentsline{app}{subsection}{\protect\numberline{\thesubsection}#1}%
}

\usepackage{listings}
\lstset{
	upquote=false,
	frame=tlrb,
	basicstyle=\ttfamily\footnotesize,
	stepnumber=1,
	showstringspaces=false,
	tabsize=4,
	breaklines=true,
	breakatwhitespace=false
}


\floatstyle{plaintop}
\restylefloat{table}

\counterwithin{figure}{section}
\counterwithin{table}{section}

\captionsetup[table]{skip=10pt}
\captionsetup[figure]{name={Gambar.},labelsep=period}

\makeatletter
\def\@kampus{PROGRAM STUDI TEKNIK INFORMATIKA\\
	SEKOLAH TEKNIK ELEKTRO DAN INFORMATIKA\\
	Institut Teknologi Bandung}

\newcommand{\MONTH}{%
	\ifcase\the\month
	\or Januari% 1
	\or Februari% 2
	\or Maret% 3
	\or April% 4
	\or Mei% 5
	\or Juni% 6
	\or Juli% 7
	\or Agustus% 8
	\or September% 9
	\or Oktober% 10
	\or November% 11
	\or Desember% 12
	\fi}

%\def\@maketitle{   % custom maketitle
\newcommand{\judul}{   % custom maketitle

\begin{center}
\smallskip
\large \bfseries \MakeUppercase{\thetitle}
\vfill
\large Laporan Tugas Akhir\\
\vfill
Disusun sebagai syarat kelulusan tingkat sarjana\\
\vfill
oleh\\
\large \theauthor
\vfill
\begin{figure}[h]
\centering
  	\includegraphics[width=0.15\textwidth]{resources/cover-ganesha.jpg}
\end{figure}
\vfill
\large
\@kampus \\
\large
\MONTH\space\the\year

\end{center}
}
\makeatother

\sectionfont{\normalsize}
\subsectionfont{\normalsize}

\renewcommand{\thechapter}{\Roman{chapter}}

\bibliography{references}

\begin{document}

\title{Implementasi Deep Packet Inspection pada Iptables sebagai Penangkal Infeksi Malware Melalui Jaringan}
\date{}
\author{IBROHIM KHOLILUL ISLAM\\
NIM : 13513090}

\input{chapters/cover}
\input{chapters/approval}

\pagenumbering{roman}
\setcounter{page}{0}

\pagestyle{plain}

\input{chapters/abstract-id}
\input{chapters/forewords}
\clearpage

\tableofcontents
\clearpage
\listofappendix
\clearpage
\listoffigures
\clearpage
\listoftables
\clearpage

\pagenumbering{arabic}
\setcounter{page}{1}

\input{chapters/chapter-1}

\input{chapters/chapter-2}

\input{chapters/chapter-3}

\input{chapters/chapter-4}

\input{chapters/chapter-5}


\printbibliography[heading=bibintoc,title={Daftar Referensi}]

\appendix
\part*{LAMPIRAN}

\captionsetup[figure]{list=no}
\captionsetup[table]{list=no}

\input{chapters/appendix-1}
\input{chapters/appendix-2}


\end{document}
